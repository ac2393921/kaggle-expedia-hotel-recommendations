from datetime import datetime

import numpy as np
from pandera import Column, DataFrameSchema, Index

DTYPES = {
    "site_name": np.uint8,
    "posa_continent": np.uint8,
    "user_location_country": np.uint16,
    "user_location_region": np.uint16,
    "user_location_city": np.uint16,
    "orig_destination_distance": np.float32,
    "user_id": np.uint32,
    "is_mobile": bool,
    "is_package": bool,
    "channel": np.uint8,
    "srch_adults_cnt": np.uint8,
    "srch_children_cnt": np.uint8,
    "srch_rm_cnt": np.uint8,
    "srch_destination_id": np.uint32,
    "srch_destination_type_id": np.uint8,
    "is_booking": bool,
    "cnt": np.uint64,
    "hotel_continent": np.uint8,
    "hotel_country": np.uint16,
    "hotel_market": np.uint16,
    "hotel_cluster": np.uint8,
}

BASE_SCHEMA = DataFrameSchema(
    columns={
        "date_time": Column(datetime),
        "site_name": Column(np.uint8, required=False),
        "posa_continent": Column(np.uint8, required=False),
        "user_location_country": Column(np.uint16, required=False),
        "user_location_region": Column(np.uint16, required=False),
        "user_location_city": Column(np.uint16, required=False),
        "orig_destination_distance": Column(np.float32, required=False, coerce=True),
        "user_id": Column(np.uint32, required=False),
        "is_mobile": Column(np.uint8, required=False),
        "is_package": Column(np.uint8, required=False),
        "channel": Column(np.uint8, required=False),
        "srch_ci": Column(datetime),
        "srch_co": Column(datetime),
        "srch_adults_cnt": Column(np.uint8, required=False),
        "srch_children_cnt": Column(np.uint8, required=False),
        "srch_rm_cnt": Column(np.uint8, required=False),
        "srch_destination_id": Column(np.uint32, required=False),
        "srch_destination_type_id": Column(np.uint8, required=False),
        "is_booking": Column(int, required=False),
        "cnt": Column(np.uint64, required=False),
        "hotel_continent": Column(np.uint8, required=False),
        "hotel_country": Column(np.uint16, required=False),
        "hotel_market": Column(np.uint16, required=False),
        "hotel_cluster": Column(np.uint8, required=False),
    },
    index=Index(int),
    strict=True,
    coerce=True,
)
